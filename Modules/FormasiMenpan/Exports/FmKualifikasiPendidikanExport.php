<?php
/*   _______________________________________
    |  Dikembangkan oleh - Raden Parhanudin |
    |    Whatsapp: https://6282342788059    |
    |_______________________________________|
*/
 namespace Modules\FormasiMenpan\Exports; use Maatwebsite\Excel\Concerns\FromCollection; use Maatwebsite\Excel\Concerns\ShouldAutoSize; use Maatwebsite\Excel\Concerns\WithHeadings; use Maatwebsite\Excel\Concerns\WithMapping; use Maatwebsite\Excel\Concerns\WithStyles; use PhpOffice\PhpSpreadsheet\Worksheet\Worksheet; use PhpOffice\PhpSpreadsheet\Cell\Cell; use PhpOffice\PhpSpreadsheet\Cell\DataType; use Maatwebsite\Excel\Concerns\WithCustomValueBinder; use Modules\FormasiMenpan\Entities\FmKualifikasiPendidikan; use PhpOffice\PhpSpreadsheet\Cell\DefaultValueBinder; class FmKualifikasiPendidikanExport extends DefaultValueBinder implements WithCustomValueBinder, FromCollection, WithHeadings, ShouldAutoSize, WithStyles, WithMapping { public function collection() { $data = FmKualifikasiPendidikan::orderBy("\x61\156\x6a\141\x62\x5f\x6e\x61\x6d\x61")->get(); return collect($data); } public function map($data) : array { return ["\151\144" => $data->id, "\141\156\152\141\142\x5f\151\x64" => $data->anjab_id, "\x61\x6e\152\141\x62\x5f\x6e\141\155\x61" => $data->anjab_nama, "\160\x65\156\x64\x69\x64\151\x6b\141\156\137\x69\x64" => $data->pendidikan_id, "\160\145\x6e\x64\x69\x64\x69\x6b\141\x6e\137\156\x61\x6d\141" => $data->pendidikan_nama]; } public function headings() : array { return ["\111\x44", "\101\x6e\152\x61\142\x20\111\104", "\x41\156\x6a\141\142\x20\116\x61\155\141", "\120\145\x6e\144\151\144\x69\x6b\x61\156\40\111\x44", "\x50\x65\x6e\144\151\x64\151\x6b\x61\156\40\116\x61\155\x61"]; } public function styles(Worksheet $sheet) { return [1 => ["\x66\x6f\x6e\164" => ["\142\157\154\144" => true]]]; } public function bindValue(Cell $cell, $value) { if (is_numeric($value)) { $cell->setValueExplicit($value, DataType::TYPE_STRING); return true; } return parent::bindValue($cell, $value); } }
