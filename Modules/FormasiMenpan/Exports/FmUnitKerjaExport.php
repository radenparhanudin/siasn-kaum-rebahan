<?php
/*   _______________________________________
    |  Dikembangkan oleh - Raden Parhanudin |
    |    Whatsapp: https://6282342788059    |
    |_______________________________________|
*/
 namespace Modules\FormasiMenpan\Exports; use Maatwebsite\Excel\Concerns\FromCollection; use Maatwebsite\Excel\Concerns\ShouldAutoSize; use Maatwebsite\Excel\Concerns\WithHeadings; use Maatwebsite\Excel\Concerns\WithMapping; use Maatwebsite\Excel\Concerns\WithStyles; use PhpOffice\PhpSpreadsheet\Worksheet\Worksheet; use PhpOffice\PhpSpreadsheet\Cell\Cell; use PhpOffice\PhpSpreadsheet\Cell\DataType; use Maatwebsite\Excel\Concerns\WithCustomValueBinder; use Modules\FormasiMenpan\Entities\FmUnitKerja; use PhpOffice\PhpSpreadsheet\Cell\DefaultValueBinder; class FmUnitKerjaExport extends DefaultValueBinder implements WithCustomValueBinder, FromCollection, WithHeadings, ShouldAutoSize, WithStyles, WithMapping { public function collection() { $data = FmUnitKerja::orderBy("\156\141\155\141")->get(); return collect($data); } public function map($data) : array { return ["\151\144" => $data->id, "\x6e\x61\155\141" => $data->nama, "\x61\154\x61\x6d\141\164" => $data->alamat, "\x74\x65\x6c\145\x70\157\156" => $data->telepon, "\x6b\145\x74\x65\x72\141\x6e\147\141\x6e" => $data->keterangan, "\163\164\x61\x74\165\163" => $data->status]; } public function headings() : array { return ["\111\104", "\116\141\x6d\x61\x20\125\156\x69\164\40\113\145\162\x6a\x61\x20\x2f\x20\x4b\x61\156\164\157\x72", "\x41\x6c\x61\155\x61\x74", "\124\x65\x6c\145\x70\x6f\156", "\113\145\x74\145\x72\x61\x6e\147\141\x6e"]; } public function styles(Worksheet $sheet) { return [1 => ["\146\157\x6e\x74" => ["\x62\x6f\154\x64" => true]]]; } public function bindValue(Cell $cell, $value) { if (is_numeric($value)) { $cell->setValueExplicit($value, DataType::TYPE_STRING); return true; } return parent::bindValue($cell, $value); } }
