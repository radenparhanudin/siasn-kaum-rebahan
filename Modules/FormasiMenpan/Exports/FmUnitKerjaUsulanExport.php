<?php
/*   _______________________________________
    |  Dikembangkan oleh - Raden Parhanudin |
    |    Whatsapp: https://6282342788059    |
    |_______________________________________|
*/
 namespace Modules\FormasiMenpan\Exports; use Maatwebsite\Excel\Concerns\FromCollection; use Maatwebsite\Excel\Concerns\ShouldAutoSize; use Maatwebsite\Excel\Concerns\WithHeadings; use Maatwebsite\Excel\Concerns\WithMapping; use Maatwebsite\Excel\Concerns\WithStyles; use PhpOffice\PhpSpreadsheet\Worksheet\Worksheet; use PhpOffice\PhpSpreadsheet\Cell\Cell; use PhpOffice\PhpSpreadsheet\Cell\DataType; use Maatwebsite\Excel\Concerns\WithCustomValueBinder; use Modules\FormasiMenpan\Entities\FmUnitKerjaUsulan; use PhpOffice\PhpSpreadsheet\Cell\DefaultValueBinder; class FmUnitKerjaUsulanExport extends DefaultValueBinder implements WithCustomValueBinder, FromCollection, WithHeadings, ShouldAutoSize, WithStyles, WithMapping { public function collection() { $data = FmUnitKerjaUsulan::whereIn("\x73\x74\141\164\165\163\137\165\x73\x75\154\x61\x6e", ["\124\141\155\x62\141\150", "\125\x62\x61\x68"])->get(); return collect($data); } public function map($data) : array { return ["\x69\x64" => $data->id, "\146\x6d\x5f\x75\x6e\151\164\x5f\x6b\x65\162\152\141\x5f\151\x64" => $data->fm_unit_kerja_id, "\156\x61\x6d\141" => $data->nama, "\x61\x6c\141\x6d\141\x74" => $data->alamat, "\164\145\154\x65\x70\x6f\156" => $data->telepon, "\x6b\x65\x74\x65\162\x61\x6e\x67\x61\156" => $data->keterangan]; } public function headings() : array { return ["\x49\104", "\x55\156\151\164\x20\x4b\145\162\152\x61\40\x49\104", "\x4e\141\x6d\x61\x20\125\156\x69\164\x20\113\145\162\x6a\141\40\57\40\x4b\141\x6e\x74\x6f\x72", "\101\x6c\x61\155\x61\164", "\124\145\x6c\145\x70\x6f\x6e", "\x4b\145\164\x65\x72\x61\156\147\x61\156"]; } public function styles(Worksheet $sheet) { return [1 => ["\x66\x6f\x6e\164" => ["\142\x6f\154\144" => true]]]; } public function bindValue(Cell $cell, $value) { if (is_numeric($value)) { $cell->setValueExplicit($value, DataType::TYPE_STRING); return true; } return parent::bindValue($cell, $value); } }
