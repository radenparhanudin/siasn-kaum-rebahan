<?php
/*   _______________________________________
    |  Dikembangkan oleh - Raden Parhanudin |
    |    Whatsapp: https://6282342788059    |
    |_______________________________________|
*/
 namespace Modules\FormasiMenpan\Exports; use Maatwebsite\Excel\Concerns\FromCollection; use Maatwebsite\Excel\Concerns\ShouldAutoSize; use Maatwebsite\Excel\Concerns\WithHeadings; use Maatwebsite\Excel\Concerns\WithMapping; use Maatwebsite\Excel\Concerns\WithStyles; use PhpOffice\PhpSpreadsheet\Worksheet\Worksheet; use PhpOffice\PhpSpreadsheet\Cell\Cell; use PhpOffice\PhpSpreadsheet\Cell\DataType; use Maatwebsite\Excel\Concerns\WithCustomValueBinder; use Modules\FormasiMenpan\Entities\FmStrukturJabatanUsulan; use PhpOffice\PhpSpreadsheet\Cell\DefaultValueBinder; class FmStrukturJabatanUsulanExport extends DefaultValueBinder implements WithCustomValueBinder, FromCollection, WithHeadings, ShouldAutoSize, WithStyles, WithMapping { public function collection() { $data = FmStrukturJabatanUsulan::whereIn("\x73\164\141\x74\165\x73\x5f\x75\163\165\x6c\x61\156", ["\x54\x61\x6d\142\141\150"])->orderBy("\156\x6f\155\157\162")->get(); return collect($data); } public function map($data) : array { return ["\151\x64" => $data->id, "\146\x6d\137\x73\x74\162\x75\x6b\x74\165\x72\x5f\x6a\141\142\141\164\x61\x6e\137\x69\144" => $data->fm_struktur_jabatan_id, "\156\x6f\x6d\157\162" => $data->nomor, "\160\x61\162\145\156\164\137\x6e\x6f\x6d\157\x72" => $data->parent_nomor, "\160\x61\162\x65\156\x74\x5f\160\x6f\163\x69\163\151\x5f\x69\x64" => $data->parent_posisi_id, "\160\157\x73\151\163\x69\137\151\x64" => $data->posisi_id, "\156\141\155\x61\137\x6a\x61\x62\x61\164\x61\x6e" => $data->nama_jabatan, "\152\x66\x75\137\151\144" => $data->jfu_id, "\152\x66\x75\x5f\156\141\155\x61" => $data->jfu_nama, "\152\x66\x74\137\151\x64" => $data->jft_id, "\x6a\146\164\x5f\x6e\141\155\141" => $data->jft_nama, "\x6e\x70\163\156" => $data->npsn, "\x73\145\x6b\157\154\141\150" => $data->sekolah, "\x66\141\x73\153\x65\x73\137\x69\144" => $data->faskes_id, "\x66\x61\x73\x6b\145\163\x5f\156\x61\155\141" => $data->faskes_nama, "\153\145\x6c\141\x73" => $data->kelas, "\x61\x62\153" => $data->abk, "\165\156\151\164\137\153\x65\162\x6a\141\137\151\x64" => $data->unit_kerja_id]; } public function headings() : array { return ["\x49\104", "\123\164\x72\165\x6b\x74\165\x72\x20\x4a\141\x62\141\x74\141\x6e\x20\111\104", "\x4e\157\155\x6f\162", "\x50\x61\x72\145\156\x74\40\x4e\157\x6d\157\x72", "\120\141\x72\x65\156\164\40\x50\x6f\163\x69\x73\x69\40\x49\104", "\x50\157\163\x69\x73\151\x20\111\x44", "\116\x61\x6d\141\x20\x4a\141\x62\141\164\x61\156", "\x4a\x46\x55\40\x49\104", "\x4a\106\x55\x20\116\141\x6d\141", "\112\x46\124\x20\x49\104", "\x4a\x46\x54\x20\x4e\x61\x6d\141", "\x4e\120\123\116", "\116\x61\155\141\x20\x53\x65\x6b\x6f\154\x61\x68", "\x46\141\x73\153\145\163\40\111\104", "\x46\141\x73\153\x65\x73\40\116\x61\x6d\x61", "\x4b\145\154\141\x73", "\x41\x42\x4b", "\x55\156\x69\164\x20\113\145\x72\152\x61\40\111\x44"]; } public function styles(Worksheet $sheet) { return [1 => ["\x66\157\x6e\164" => ["\142\157\154\x64" => true]]]; } public function bindValue(Cell $cell, $value) { if (is_numeric($value)) { $cell->setValueExplicit($value, DataType::TYPE_STRING); return true; } return parent::bindValue($cell, $value); } }
