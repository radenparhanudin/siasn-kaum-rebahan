<?php
/*   _______________________________________
    |  Dikembangkan oleh - Raden Parhanudin |
    |    Whatsapp: https://6282342788059    |
    |_______________________________________|
*/
 namespace Modules\ProfileASN\Exports; use Maatwebsite\Excel\Concerns\FromCollection; use Maatwebsite\Excel\Concerns\ShouldAutoSize; use Maatwebsite\Excel\Concerns\WithHeadings; use Maatwebsite\Excel\Concerns\WithMapping; use Modules\ProfileASN\Entities\Asn; use Maatwebsite\Excel\Concerns\WithStyles; use PhpOffice\PhpSpreadsheet\Worksheet\Worksheet; use PhpOffice\PhpSpreadsheet\Cell\Cell; use PhpOffice\PhpSpreadsheet\Cell\DataType; use Maatwebsite\Excel\Concerns\WithCustomValueBinder; use PhpOffice\PhpSpreadsheet\Cell\DefaultValueBinder; class ProfileASNExport extends DefaultValueBinder implements WithCustomValueBinder, FromCollection, WithHeadings, ShouldAutoSize, WithStyles, WithMapping { protected $filter; public function __construct($filter) { $this->filter = $filter; } public function collection() { goto XxN1q; XxN1q: $asns = Asn::with("\x61\147\141\x6d\x61", "\164\145\155\x70\141\x74\x5f\x6c\x61\x68\151\162", "\x6a\145\x6e\151\x73\x5f\x6b\141\167\x69\x6e", "\152\x65\x6e\151\163\x5f\160\145\147\x61\x77\141\x69", "\x6b\x65\144\165\144\x75\153\141\x6e\137\150\165\153\165\x6d", "\x67\x6f\154\x6f\x6e\147\141\x6e\137\x61\x77\141\154", "\x67\157\154\x6f\156\x67\141\x6e", "\152\x65\156\151\x73\137\x6a\x61\142\141\164\141\156", "\x65\x73\145\154\157\156", "\152\x66\x74", "\152\x66\165", "\x74\x6b\x5f\x70\x65\156\144\151\144\x69\153\x61\x6e", "\160\145\156\x64\151\144\x69\153\x61\156", "\x6b\x70\x6b\x6e", "\154\x6f\153\141\x73\151\137\153\x65\x72\152\141", "\x75\x6e\x69\164\x5f\157\162\147\x61\x6e\x69\163\141\x73\151"); goto yBTcn; IZhZ3: return collect($asns->orderBy("\x69\144")->get()); goto CVHES; yBTcn: foreach ($this->filter as $key => $value) { $asns->where($key, $value); } goto IZhZ3; CVHES: } public function map($asns) : array { goto Vx6gy; dy7nh: if (!empty($tempat_lahir)) { [$tempat_lahir, $_] = explode("\40\x2d\x20", $tempat_lahir, 2); } goto U3sRd; Vx6gy: $tempat_lahir = $asns->tempat_lahir->nama ?? ''; goto dy7nh; U3sRd: return ["\x69\x64" => $asns->id, "\156\x69\x70\137\x6c\x61\x6d\141" => $asns->nip_lama, "\x6e\151\x70\137\x62\141\162\x75" => $asns->nip_baru, "\156\141\155\x61" => $asns->nama, "\156\x61\x6d\x61\137\154\x65\156\147\153\141\160" => $asns->nama_lengkap, "\147\145\154\x61\x72\137\144\x65\x70\141\x6e" => $asns->gelar_depan, "\x67\x65\154\x61\x72\x5f\142\145\x6c\141\153\x61\x6e\147" => $asns->gelar_belakang, "\x61\147\x61\155\141\x5f\151\x64" => $asns->agama_id, "\x61\x67\x61\x6d\x61\137\156\x61\x6d\x61" => $asns->agama->nama ?? '', "\x74\145\155\x70\141\x74\x5f\154\141\150\151\x72\137\151\x64" => $asns->tempat_lahir_id, "\164\x65\155\x70\141\164\137\x6c\141\150\151\x72\137\x6e\x61\155\141" => $tempat_lahir, "\x74\x61\156\147\147\141\x6c\x5f\x6c\x61\150\151\x72" => $asns->tanggal_lahir, "\152\x65\156\151\163\137\x6b\x65\154\x61\x6d\x69\156" => $asns->jenis_kelamin, "\x6a\145\156\151\163\137\153\141\x77\151\156\x5f\151\144" => $asns->jenis_kawin_id, "\152\145\x6e\x69\x73\137\153\x61\167\151\x6e\x5f\x6e\141\155\141" => $asns->jenis_kawin->nama ?? '', "\156\151\153" => $asns->nik, "\x6e\157\x6d\x6f\162\x5f\x68\160" => $asns->nomor_hp, "\156\x6f\155\x6f\162\x5f\164\145\154\160\157\x6e" => $asns->nomor_telpon, "\x65\155\x61\x69\154" => $asns->email, "\145\x6d\x61\x69\x6c\x5f\147\x6f\166" => $asns->email_gov, "\x61\154\x61\155\141\164" => $asns->alamat, "\156\160\167\160\137\x6e\157\x6d\x6f\x72" => $asns->npwp_nomor, "\156\x6f\x6d\157\162\x5f\142\x70\152\163" => $asns->nomor_bpjs, "\x6a\x65\156\151\163\137\x70\x65\147\x61\x77\141\151\x5f\x69\144" => $asns->jenis_pegawai_id, "\152\145\156\x69\x73\x5f\x70\x65\x67\141\x77\141\x69\x5f\x6e\x61\x6d\141" => $asns->jenis_pegawai->nama ?? '', "\153\x65\144\165\x64\165\x6b\x61\x6e\x5f\x68\165\x6b\165\x6d\x5f\151\x64" => $asns->kedudukan_hukum_id, "\x6b\x65\144\x75\x64\x75\x6b\141\x6e\x5f\x68\x75\153\165\x6d\137\156\141\x6d\141" => $asns->kedudukan_hukum->nama ?? '', "\x73\x74\x61\164\x75\163\137\143\x70\x6e\163\x5f\x70\x6e\163" => $asns->status_cpns_pns, "\153\x61\162\x74\165\137\160\x65\147\x61\x77\x61\x69" => $asns->kartu_pegawai, "\156\157\155\x6f\x72\137\x73\x6b\137\143\160\x6e\163" => $asns->nomor_sk_cpns, "\164\147\x6c\x5f\x73\153\137\143\160\156\x73" => $asns->tgl_sk_cpns, "\164\x6d\164\x5f\x63\160\x6e\163" => $asns->tmt_cpns, "\x6e\x6f\155\x6f\162\x5f\x73\x6b\137\x70\156\163" => $asns->nomor_sk_pns, "\x74\x67\154\x5f\x73\x6b\x5f\160\x6e\x73" => $asns->tgl_sk_pns, "\x74\x6d\x74\x5f\160\x6e\163" => $asns->tmt_pns, "\x67\x6f\154\157\156\147\x61\x6e\137\141\167\141\x6c\137\x69\144" => $asns->golongan_awal_id, "\147\x6f\x6c\157\156\x67\x61\x6e\137\141\167\141\x6c\x5f\156\141\155\x61" => $asns->golongan_awal->nama ?? '', "\x67\x6f\x6c\x6f\x6e\x67\141\x6e\x5f\x69\144" => $asns->golongan_id, "\147\x6f\x6c\157\156\147\x61\x6e\137\156\x61\x6d\141" => $asns->golongan->nama ?? '', "\x74\x6d\x74\137\x67\x6f\x6c\x6f\x6e\x67\x61\x6e" => $asns->tmt_golongan, "\x6d\153\x5f\164\141\150\x75\x6e" => $asns->mk_tahun, "\x6d\x6b\x5f\x62\x75\x6c\141\x6e" => $asns->mk_bulan, "\x6a\145\156\x69\163\137\x6a\141\x62\x61\x74\141\156\x5f\151\144" => $asns->jenis_jabatan_id, "\152\x65\156\151\x73\137\x6a\141\142\141\x74\x61\x6e\137\156\x61\155\x61" => $asns->jenis_jabatan->nama ?? '', "\x65\x73\145\x6c\x6f\x6e\x5f\x69\x64" => $asns->eselon_id, "\145\163\x65\x6c\x6f\156\137\156\x61\x6d\x61" => $asns->eselon->nama ?? '', "\152\146\164\137\x69\144" => $asns->jft_id, "\x6a\x66\164\x5f\156\x61\155\x61" => $asns->jft->nama ?? '', "\x6a\146\x75\137\x69\144" => $asns->jfu_id, "\x6a\146\x75\137\x6e\x61\155\x61" => $asns->jfu->nama ?? '', "\x74\x6d\x74\137\152\x61\x62\x61\x74\141\156" => $asns->tmt_jabatan, "\164\x6b\x5f\160\x65\x6e\x64\x69\x64\151\153\141\x6e\137\x69\144" => $asns->tk_pendidikan_id, "\164\x6b\137\160\145\x6e\x64\x69\144\x69\x6b\x61\x6e\x5f\156\x61\155\x61" => $asns->tk_pendidikan->nama ?? '', "\160\x65\156\144\151\144\151\153\x61\156\137\151\144" => $asns->pendidikan_id, "\160\145\x6e\x64\x69\144\x69\153\x61\x6e\137\x6e\141\155\141" => $asns->pendidikan->nama ?? '', "\164\x61\x6e\x67\x67\141\154\137\154\165\154\x75\163" => $asns->tanggal_lulus, "\x6b\160\x6b\156\137\x69\144" => $asns->kpkn_id, "\153\160\x6b\156\x5f\156\x61\155\141" => $asns->kpkn->nama ?? '', "\154\x6f\x6b\141\163\151\137\x6b\x65\162\x6a\141\137\151\x64" => $asns->lokasi_kerja_id, "\154\x6f\x6b\x61\163\x69\x5f\x6b\x65\162\152\x61\137\156\141\155\x61" => $asns->lokasi_kerja->nama ?? '', "\x75\x6e\151\x74\x5f\x6f\162\147\x61\x6e\x69\x73\141\x73\x69\137\151\x64" => $asns->unit_organisasi_id, "\x75\156\151\x74\x5f\157\x72\x67\x61\x6e\151\x73\x61\x73\151\137\156\141\155\x61" => $asns->unit_organisasi->nama_unor ?? '']; goto wF5Lp; wF5Lp: } public function headings() : array { return ["\x49\104", "\116\x49\x50\40\114\x41\115\101", "\x4e\x49\x50\x20\x42\x41\122\125", "\x4e\x41\115\x41", "\x4e\101\115\x41\x20\114\105\x4e\107\x4b\101\x50", "\107\x45\x4c\101\x52\x20\104\x45\120\101\116", "\107\105\114\x41\x52\x20\102\105\114\101\x4b\101\x4e\107", "\101\x47\x41\x4d\101\40\x49\104", "\101\107\101\x4d\101\x20\116\101\115\x41", "\x54\x45\115\x50\101\124\40\114\x41\x48\x49\x52\x20\x49\x44", "\124\105\x4d\120\101\124\x20\x4c\x41\110\x49\x52\40\116\101\115\x41", "\124\101\116\107\x47\x41\x4c\x20\x4c\101\110\111\122", "\x4a\x45\116\x49\x53\x20\113\x45\114\101\115\x49\116", "\x4a\105\x4e\x49\x53\x20\113\x41\127\111\x4e\40\111\x44", "\112\x45\116\x49\123\40\113\x41\x57\x49\x4e\40\x4e\101\115\x41", "\116\x49\x4b", "\x4e\117\x4d\117\x52\40\110\x50", "\x4e\117\x4d\x4f\122\40\x54\x45\114\x50\x4f\116", "\x45\115\101\x49\114", "\x45\x4d\x41\x49\114\40\x47\117\126", "\x41\x4c\101\x4d\x41\x54", "\x4e\120\x57\120\x20\x4e\x4f\x4d\x4f\122", "\x4e\117\115\x4f\122\x20\102\120\x4a\123", "\x4a\x45\116\111\x53\40\x50\105\x47\x41\x57\101\111\40\x49\x44", "\x4a\x45\x4e\x49\123\40\x50\x45\107\x41\127\101\x49\40\x4e\x41\x4d\101", "\113\105\104\125\x44\125\113\101\x4e\x20\110\125\113\125\x4d\x20\x49\104", "\x4b\105\104\125\x44\x55\x4b\x41\x4e\x20\110\125\113\125\115\40\116\x41\x4d\101", "\123\124\x41\124\x55\x53\40\103\x50\116\x53\40\x50\116\x53", "\113\x41\122\x54\125\x20\120\x45\107\101\127\x41\x49", "\116\x4f\115\x4f\122\x20\x53\x4b\40\103\x50\x4e\x53", "\x54\107\114\40\123\113\x20\103\120\116\x53", "\x54\115\x54\x20\103\120\116\123", "\x4e\x4f\115\117\x52\40\123\x4b\x20\x50\x4e\x53", "\x54\107\114\x20\123\113\x20\120\x4e\x53", "\x54\x4d\x54\40\x50\x4e\123", "\107\x4f\x4c\x4f\116\x47\101\116\x20\x41\127\x41\x4c\40\x49\104", "\x47\x4f\x4c\117\116\107\101\116\40\x41\127\x41\114\40\x4e\x41\x4d\101", "\x47\117\x4c\x4f\x4e\107\x41\x4e\40\x49\104", "\x47\117\114\117\116\x47\x41\116\40\116\x41\x4d\101", "\x54\x4d\124\40\x47\x4f\114\117\116\x47\101\x4e", "\115\113\x20\x54\101\110\125\116", "\x4d\x4b\x20\x42\x55\x4c\101\116", "\x4a\x45\x4e\111\123\40\112\x41\102\101\124\101\116\40\111\104", "\x4a\x45\116\x49\123\40\x4a\101\102\x41\124\101\x4e\40\x4e\x41\x4d\x41", "\x45\x53\105\114\117\x4e\40\111\104", "\x45\123\x45\114\x4f\x4e\x20\x4e\101\x4d\101", "\112\106\x54\40\x49\104", "\112\106\x54\40\116\101\115\x41", "\112\106\125\x20\111\104", "\x4a\106\x55\40\x4e\101\x4d\x41", "\124\115\124\x20\112\x41\102\101\124\x41\116", "\x54\x4b\x20\120\105\x4e\x44\x49\x44\x49\113\x41\116\40\x49\104", "\x54\x4b\40\x50\105\x4e\x44\x49\104\111\x4b\x41\x4e\40\x4e\x41\x4d\x41", "\120\105\x4e\104\x49\x44\x49\113\x41\x4e\40\111\104", "\x50\x45\116\x44\x49\x44\111\x4b\x41\116\40\x4e\x41\115\101", "\x54\x41\x4e\x47\107\x41\114\40\114\125\x4c\125\x53", "\113\120\113\116\40\111\104", "\113\x50\113\x4e\40\x4e\x41\x4d\101", "\114\117\x4b\101\123\x49\x20\113\x45\x52\x4a\x41\x20\x49\x44", "\x4c\x4f\113\101\x53\x49\x20\x4b\x45\122\x4a\x41\40\x4e\101\115\101", "\125\x4e\x49\x54\40\x4f\122\107\x41\116\x49\123\101\123\x49\40\x49\104", "\125\116\x49\x54\40\x4f\x52\x47\101\x4e\x49\123\101\123\111\40\x4e\101\x4d\x41"]; } public function styles(Worksheet $sheet) { return [1 => ["\x66\x6f\x6e\x74" => ["\x62\x6f\154\144" => true]]]; } public function bindValue(Cell $cell, $value) { if (is_numeric($value)) { $cell->setValueExplicit($value, DataType::TYPE_STRING); return true; } return parent::bindValue($cell, $value); } }
